USE GRAPH lsqb
SET syntax_version="v2"

CREATE OR REPLACE DISTRIBUTED QUERY q8(){
SumACCUM<UINT> @@count;
OrAccum<BOOL> @hastag;

comment = SELECT c
	FROM Tag -(<HAS_TAG)- Comment:c
	Accum c.@hastag+=true;

tmp = SELECT t1
	FROM Tag:t1 -(<HAS_TAG)- Message -(<REPLY_OF)- comment:c -(HAS_TAG>)- Tag:t2
	WHERE NOT c.@hastag AND t1!=t2
	Accum @@count+=1;

PRINT @@count;
}